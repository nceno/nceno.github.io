<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    

    <title>Nceno: Workout for a payout</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">


<!-- Custom styles for this template -->
    <link href="../css/faq.css" rel="stylesheet">

   </head>

  <body>

    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="index.html">Nceno</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="alpha.html">Alpha</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="faq.html">FAQ</a>
            </li>
          </ul>
          
        </div>
      </nav>



    <main role="main" class="container">
      <div class="starter-template">
        <h1>Nceno v0.2a</h1>
        
        

 <section class="accordion-section clearfix mt-3" aria-label="Question Accordions">
  <div class="container">
  
    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
    <div class="panel panel-default">
      <div class="panel-heading p-3 mb-3" role="tab" id="heading0">
      <h3 class="panel-title">
        <a class="collapsed" role="button" title="" data-toggle="collapse" data-parent="#accordion" href="#collapse0" aria-expanded="true" aria-controls="collapse0">
        Sign in
        </a>
      </h3>
      </div>
      <div id="collapse0" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading0">
      <div class="panel-body px-3 mb-4">

        <p>Nceno uses several services to interact with the blockchain (Portis) and verify your workout (Fitbit). Thus, you need to sign in to them before continuing.</p>

        <!--<button onclick="showPortis()">Show Portis</button>
        <button onclick="getAccounts()">Get accounts</button>
        <div id="result"></div>
        <div id="address"></div>-->
        
        <p>Step 1:</p><button onclick="showPortis()" id="portisBtn" type="button" class="btn btn-primary">Log into Portis</button>
        <p>Step 2:</p><a id="fitbitBtn" type="button" class="btn btn-primary" href="https://www.fitbit.com/oauth2/authorize?response_type=token&client_id=22D5SN&redirect_uri=https%3A%2F%2Fwww.nceno.app%2Fnew_setGoal.html&scope=activity%20heartrate%20location%20profile&expires_in=604800">Log into Fitbit</a>
        <p>Step 3 (One-time):</p>
        <span id="insTrans"></span>
        <!--modal-->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Create an Nceno account</button>
          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">New Nceno account</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <form>
                    <div class="form-group">
                      <label for="recipient-name" class="col-form-label">Name</label>
                      <input type="text" class="form-control" id="name">
                    </div>
                    <div class="form-group">
                      <label for="recipient-name" class="col-form-label">Email</label>
                      <input type="text" class="form-control" id="email">
                    </div>
                    <div class="form-group">
                      <label for="recipient-name" class="col-form-label">Wearable make/model</label>
                      <input type="text" class="form-control" id="wearable">
                    </div>
                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button id="makeAcctBtn" type="button" class="btn btn-primary">Make account</button>
                  <!--<img id="loader" src="https://loading.io/spinners/double-ring/lg.double-ring-spinner.gif">-->
                  <h2 id="profCre"></h2>
                </div>
              </div>
            </div>
          </div>
          <!--modal-->
        

      </div>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-heading p-3 mb-3" role="tab" id="heading1">
      <h3 class="panel-title">
        <a class="collapsed" role="button" title="" data-toggle="collapse" data-parent="#accordion" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
        Host a new challenge
        </a>
      </h3>
      </div>
      <div id="collapse1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading1">
      <div class="panel-body px-3 mb-4">

        <p>You are about to set a goal and stake some crypto on your progress.</p> 
          <div class="form-group form-check">
            <input type="checkbox" class="form-check-input" id="checker">
            <label class="form-check-label" for="checker">I've read the <a href="instructions.html">instructions</a> and agree to the <a href="terms.html">terms</a>.</label>
          </div>

      <form>
       

      <div class="form-group">
        <label for="exampleFormControlSelect1">Minutes per exercise session:</label>
        <select class="form-control" id="activeMinsDD">
          <option>20</option>
          <option>30</option>
          <option>40</option>
          <option>50</option>
          <option>60</option>
          <option>70</option>
          <option>80</option>
          <option>90</option>
          <option>100</option>
          <option>110</option>
          <option>120</option>
        </select>
      </div>

      <div class="form-group">
        <label for="exampleFormControlSelect1">Exercise sessions per week:</label>
        <select class="form-control" id="sesPerWkDD">
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5</option>
          <option>6</option>
          <option>7</option>
        </select>
      </div>

      <div class="form-group">
        <label for="exampleFormControlSelect1">Challenge duration in weeks:</label>
        <select class="form-control" id="wksDD">
          <option>2</option>
          <option>4</option>
          <option>6</option>
          <option>8</option>
          <option>10</option>
          <option>12</option>
        </select>
      </div>

      
       <div class="form-group">
        <label for="exampleFormControlSelect1">Stake in $USD:</label>
        <select class="form-control" id="stakeDD">
          <option>5</option>
          <option>8</option>
          <option>10</option>
          <option>20</option>
          <option>35</option>
          <option>40</option>
          <option>50</option>
          <option>75</option>
          <option>88</option>
          <option>100</option>
          <option>150</option>
          <option>250</option>
          <option>500</option>
          <option>888</option>
          <option>1000</option>
          <option>1500</option>
          <option>2500</option>
          <option>5000</option>
          <option>8888</option>
          </select>
      </div> 

        
            <div class="form-group">
              <label for="exampleFormControlSelect1">Starting time:</label>
                <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                    <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1"/>
                    <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
                </div>
            </div>
                
   
        

      </form>                            
                
        <button onclick="echoGoal()" type="button" id="createBtn" class="btn btn-primary" data-toggle="modal" data-target="#popupCreate" data-whatever="@mdo">Create this challenge</button>

        <!--modal-->
          <div class="modal fade" id="popupCreate" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Confirm your challenge:</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <p id="goalEcho"></p> 
                </div> 
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <button id="hostBtn" type="button" class="btn btn-primary">Host this challenge</button>
                </div>
              </div>
            </div>
          </div>
          <!--modal-->

          <!--<div class="alert alert-warning alert-dismissible fade show" role="alert">
            <strong>Success!</strong> This challenge's ID is CH0112NCN. Share it with your friends and they can join you when it starts!
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div> -->

      </div>
      </div>
    </div>
    <!-- var item = $('#menuDD').find(":selected").text(); -->
    <div class="panel panel-default">
      <div class="panel-heading p-3 mb-3" role="tab" id="heading2">
      <h3 class="panel-title">
        <a class="collapsed" role="button" title="" data-toggle="collapse" data-parent="#accordion" href="#collapse2" aria-expanded="true" aria-controls="collapse2">
        My challenges
        </a>
      </h3>
      </div>
      <div id="collapse2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading2">
      <div class="panel-body px-3 mb-4">

        <p>Here are your active and upcoming challenges. Use these tools to unlock your stake.</p>
        <form>
        <div class="form-group">
        <label for="exampleFormControlSelect1">Select one of your challenges:</label>
        <select class="form-control" id="exampleFormControlSelect1">
          <option>NCN0123</option>
          <option>NCN9940</option>
          <option>NCN0012</option>
        </select>
      </div>
        </form>

        <button id="logBtn" type="button" class="btn btn-primary">Log a workout</button>
        <button id="claimBtn" type="button" class="btn btn-primary">Claim lost stake</button>
        <button id="statsBtn" type="button" class="btn btn-secondary">My stats</button>
        <button id="leaderBtn" type="button" class="btn btn-secondary">Leaderboard</button>

        <div class="table-responsive">
        <table class="table">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Adherence %</th>
      <th scope="col">Name</th>
      <th scope="col">Global Rank #</th>
      <th scope="col">Profit $</th>      
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">97%</th>
      <td>MarkFit</td>
      <td>16</td>
      <td>$22.03</td>
      
    </tr>
    <tr>
      <th scope="row">82%</th>
      <td>Zoe16</td>
      <td>1034</td>
      <td>$6.15</td>
    </tr>
    <tr>
      <th scope="row">71%</th>
      <td>ZebraFish123</td>
      <td>433</td>
      <td>-$8.54</td>
    </tr>
  </tbody>
</table>
</div>

      </div>
      </div>
    </div>
    
    <!-- single item -->
    <div class="panel panel-default">
      <div class="panel-heading p-3 mb-3" role="tab" id="heading3">
      <h3 class="panel-title">
        <a class="collapsed" role="button" title="" data-toggle="collapse" data-parent="#accordion" href="#collapse3" aria-expanded="true" aria-controls="collapse3">
        Browse challenges
        </a>
      </h3>
      </div>
      <div id="collapse3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading3">
      <div class="panel-body px-3 mb-4">
        

        <form>
       <div class="form-group">
         <label for="recipient-name" class="col-form-label">Search for a specific challenge by its ID:</label>
          <input type="text" class="form-control" id="searchByID">
        </div>
        </form>
        <button id="searchBtn" type="button" class="btn btn-primary">Search</button>

        <p> Here are upcoming challenges that others are hosting. If you see one you like, you can join it to compete for a cut of lost stake.</p>
        <div class="table-responsive">
        <table class="table">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Buy-in</th>
      <th scope="col">Duration</th>
      <th scope="col">Sessions</th>
      <th scope="col">Minutes</th>
      <th scope="col">Competitors</th>
      <th scope="col">Starting Date</th>
      <th scope="col">Host</th>
      <th scope="col"></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      
      <td>$50</td>
      <td>8 wks</td>
      <td>4 /wk</td>
      <td>45 min</td>
      <td>8 </td>
      <td>Jan 14</td>
      <td>Zoefit91</td>
      <td><button id="createGoalBtn" type="button" class="btn btn-primary">Join</button></td>
    </tr>
    <tr>
      
      <td>$110</td>
      <td>12 wks</td>
      <td>4 /wk</td>
      <td>60 min</td>
      <td>12 </td>
      <td>Jan 15</td>
      <td>BenShape3</td>
      <td><button id="createGoalBtn" type="button" class="btn btn-primary">Join</button></td>
    </tr>
    <tr>
      
      <td>$75</td>
      <td>6 wks</td>
      <td>3 /wk</td>
      <td>40 min</td>
      <td>20 </td>
      <td>Feb 1</td>
      <td>Kylez1023</td>
      <td><button id="createGoalBtn" type="button" class="btn btn-primary">Join</button></td>
    </tr>
  </tbody>
</table>
</div>

      </div>
      </div>
    </div>
    <!-- end single item -->
  </div>
  
  </div>
</section>


        
      </div>
    </main><!-- /.container -->


<footer class="container">
        <p class="float-right"><a href="#">Back to top</a></p>
        <p>&copy; 2017-2019 Nceno Co., Ltd. &middot; <a href="contact.html">Contact</a> &middot; <a href="terms.html">Terms of Use</a> &middot; <a href="privacy.html">Privacy Policy</a> </p>
      </footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>
    <!--<script src="separate.js"></script>-->
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js" integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/portis/dist/bundle.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css" />
    
    <script>
      //$("#loader").hide();
      var PortisProvider = window.Portis.PortisProvider;
  // Check if Web3 has been injected by the browser (Mist/MetaMask)
  if (typeof web3 !== 'undefined') {
    // Use Mist/MetaMask's provider
    web3 = new Web3(web3.currentProvider);
  } else {
      // Fallback - use Portis
      web3 = new Web3(new PortisProvider({
      apiKey: "332bfe3ea28174fa515d478e23a1b31c",
      network: 'rinkeby'
      }));
    }

   function showPortis() {
      // will only open the portis menu
      web3.currentProvider.showPortis()
    }

      
    //web3.eth.defaultAccount = web3.eth.accounts[0];
    //var firstAccount;

    web3.eth.getAccounts().then(e => { 
      web3.eth.defaultAccount = e[0];
      console.log("default: " + web3.eth.defaultAccount);
    });

    var Nceno = new web3.eth.Contract([
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "name": "_activeMins",
        "type": "uint256"
      },
      {
        "name": "_stakeWEI",
        "type": "uint256"
      },
      {
        "name": "_sesPerWk",
        "type": "uint256"
      },
      {
        "name": "_wks",
        "type": "uint256"
      },
      {
        "name": "_startTime",
        "type": "uint256"
      },
      {
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "createGoal",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "name": "profileOf",
    "outputs": [
      {
        "name": "userID",
        "type": "bytes32"
      },
      {
        "name": "wearableModel",
        "type": "bytes32"
      },
      {
        "name": "name",
        "type": "bytes32"
      },
      {
        "name": "email",
        "type": "bytes32"
      },
      {
        "name": "walletAdr",
        "type": "address"
      },
      {
        "name": "goalTotal",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_index",
        "type": "uint256"
      }
    ],
    "name": "getFutureGoal",
    "outputs": [
      {
        "name": "",
        "type": "bytes32"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "bytes32[10]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "activeCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getSingleRev",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getPastRev",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "ncenoEmergencyCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_reportedMins",
        "type": "uint256"
      },
      {
        "name": "_timeStamp",
        "type": "uint256"
      },
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "simplePayout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getActiveRev",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getMyGoalStats2",
    "outputs": [
      {
        "name": "",
        "type": "uint256[12]"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256[12]"
      },
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getLeaderBoard",
    "outputs": [
      {
        "name": "",
        "type": "bytes32[10]"
      },
      {
        "name": "",
        "type": "uint256[12][10]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_wearableModel",
        "type": "bytes32"
      },
      {
        "name": "_name",
        "type": "bytes32"
      },
      {
        "name": "_email",
        "type": "bytes32"
      }
    ],
    "name": "createCompetitor",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_newChoices",
        "type": "uint256[12][6][2]"
      }
    ],
    "name": "setPartitionChoices",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "name": "userExists",
    "outputs": [
      {
        "name": "",
        "type": "bool"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "pastCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "claimBonus",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "joinGoal",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "goalCount",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getMyGoalStats1",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "singleCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getGoalParams",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "bytes32[10]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_wearableModel",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_name",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_email",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_walletAdr",
        "type": "address"
      }
    ],
    "name": "ProfileCreated",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_activeMins",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_stakeWEI",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_sesPerWk",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_wks",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_startTime",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "GoalCreated",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "CompetitorJoined",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_wk",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_payout",
        "type": "uint256"
      }
    ],
    "name": "PayoutRedeemedBy",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_amount",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_wk",
        "type": "uint256"
      }
    ],
    "name": "BonusClaimedBy",
    "type": "event"
  }
], '0x59f96be7a037351e4a324d9d02dae27ea68af5a8');
    //var Nceno = NcenoContract.at('0xe9390c922503b98da5785e57616739379a26a699'); //test
    
        //web3.utils.randomHex(32) goalID
        console.log(Nceno);
        $("#modalCreateBtn").hide();
        //show create button only if user agrees to terms
        $("#checker").on('click', function() {
          if($("#checker").is(':checked')) {
            $("#modalCreateBtn").show();
            
          } else {
            $("#modalCreateBtn").hide();
            
          }
        });

        //call fitbit api with user creds
        //getting the access token from url
        var access_token = window.location.href.split('#')[1].split('=')[1].split('&')[0];
        // get the userID
        var fitbitUser = window.location.href.split('#')[1].split('=')[2].split('&')[0];
        var userID = web3.utils.padRight(web3.utils.toHex(fitbitUser),34);
        //log them
        console.log(access_token);
        console.log(fitbitUser);
        
//creating a competitor account
$("#makeAcctBtn").click(function() {
  Nceno.methods.createCompetitor(
    userID,
    web3.utils.padRight(web3.utils.toHex($("#wearable").val()),34),
    web3.utils.padRight(web3.utils.toHex($("#name").val()),34),
    web3.utils.padRight(web3.utils.toHex($("#email").val()),34)
  )
  .send({from: web3.eth.defaultAccount, gas: 1600000, gasPrice: 15000000000},
    function(error, result) {
      if (!error){
        $("#makeAcctBtn").hide();
        //$("#loader").show();
        //$("#insTrans").html(result.blockHash);
        console.log(result);
      }
      else
      console.error(error);
    }
  );
}); 

//creating a goal
//Date.now()/1000

var usdStake = ($("#stakeDD").val()-2)*0.0048;
var goalID = web3.utils.randomHex(32);
$("#hostBtn").click(function() {
    Nceno.methods.createGoal(
    goalID,
    $("#activeMinsDD").val(),
    web3.utils.toWei(usdStake, "ether"),
    $("#sesPerWkDD").val(),
    $("#wksDD").val(),
    $("#datetimepicker1").val(),
    userID
  )
  .send({from: web3.eth.defaultAccount, gas: 5000000, gasPrice: 15000000000},
    function(error, result) {
      if (!error){
        $("#hostBtn").hide();
        console.log(result);
      }
      else
      console.error(error);
    }
  );
});

function echoGoal(){
  $("#goalEcho").html("You're commiting $" + $("#stakeDD").val() + " to working out for " + $("#activeMinsDD").val() +"mins " + $("#sesPerWkDD").val()+" times per week for "+ $("#wksDD").val()+" weeks, starting automatically at "+ $("#datetimepicker1").val()+". The challenge ID is (save it somewhere!): "+ goalID+".");
}
/*//waiting for it to be mined
var profileCreatedEvent = Nceno.events.profileCreated({},'latest');
profileCreatedEvent.watch(function(error, result){
    if (result)
        {
          if (result.blockHash != $("#insTrans").html()) //when the creation txn is mined, and goal spawned
            console.log(result.blockHash);
            //loader hide
            $("#loader").hide();
            //echo goal creation
            $("#profCre").html('Success!'+ web3.toAscii(result.args._name) );
        } else {
            $("#loader").hide();
            console.log(error);
          }
});*/
       

 
       

$("#logBtn").click(function() {
var xhr = new XMLHttpRequest();
xhr.open('GET', 'https://api.fitbit.com/1/user/'+ fitbitUser +'/activities/heart/date/today/1d.json');
xhr.setRequestHeader("Authorization", 'Bearer ' + access_token);
xhr.onload = function() {
   if (xhr.status === 200) {
      //console.log(xhr.responseText);
      //document.write(xhr.responseText);
      
      var data = JSON.parse(xhr.responseText);
      var obj = [data];
      var fatBurn = obj[0]["activities-heart"][0].value.heartRateZones[1].minutes;
      var cardio = obj[0]["activities-heart"][0].value.heartRateZones[2].minutes;
      var peak = obj[0]["activities-heart"][0].value.heartRateZones[3].minutes;
      var formattedTime = Date.parse(obj[0]["activities-heart"][0].dateTime)/1000;

      console.log(fitbitUser +"'s active minutes for "+ obj[0]["activities-heart"][0].dateTime);
      console.log(obj[0]["activities-heart"][0].value.heartRateZones[1].minutes);
      console.log(obj[0]["activities-heart"][0].value.heartRateZones[2].minutes);
      console.log(obj[0]["activities-heart"][0].value.heartRateZones[3].minutes);
      console.log("time stamp: "+formattedTime);

      var sessionMins = fatBurn + cardio + peak;
      console.log("total session minutes to be logged: "+sessionMins);

    
      Nceno.simplePayout(
                userID, 
                sessionMins,
                formattedTime+2,
                {from: web3.eth.defaultAccount, gas: 60000, gasPrice: 5000000000},
                function(error, result) {
                    if (!error){
                      //echo the result and do some jquery loader stuff
                    }
                      else
                      console.error(error);
                })//close contract function call
    }
};
xhr.send()
});//close click(function(){

   
  
    </script>

  </body>
</html>