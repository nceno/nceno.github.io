<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="apple-touch-icon" sizes="57x57" href="app/assets/images/demo/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="app/assets/images/demo/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="app/assets/images/demo/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="app/assets/images/demo/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="app/assets/images/demo/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="app/assets/images/demo/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="app/assets/images/demo/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="app/assets/images/demo/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="app/assets/images/demo/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="app/assets/images/demo/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="app/assets/images/demo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="app/assets/images/demo/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="app/assets/images/demo/favicon-16x16.png">
    <link rel="manifest" href="app/assets/images/demo/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="app/assets/images/demo/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Nceno: The app</title>
    <link rel="stylesheet" href="app/assets/css/vendor.css" />
    <link rel="stylesheet" href="app/assets/css/style.css" />
  </head>
  <body>


    <!-- header -->
    <header class="header-sticky header-dark">
      <div class="container">
        <nav class="navbar navbar-expand-lg navbar-dark">
          <a class="navbar-brand" href="index.html">
            <img class="navbar-logo navbar-logo-light" src="app/assets/images/demo/logo/logo-light.png" alt="Logo">
            <img class="navbar-logo navbar-logo-dark" src="app/assets/images/demo/logo/logo-dark.png" alt="Logo">
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="burger"><span></span></span></button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav align-items-center mr-auto">
              <li class="nav-item">
                <a class="nav-link" href="index.html" role="button">
                  Home
                </a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  About
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="team.html">
                    <span>Team</span>
                    <p>Meet the people.</p>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="elevator.html">
                    <span>What is Nceno?</span>
                    <p>See the vision.</p>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="prototype.html">
                    <span>Mobile prototype</span>
                    <p>Feel the concept.</p>
                  </a>                  
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="index.html">
                    <span>Whitepaper</span>
                    <p>Learn the details.</p>
                  </a>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Try the app
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="instructions.html">
                    <span>Instructions & FAQ</span>
                    <p>Start here first.</p>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="app.html">
                    <span>Host, join, or manage a challenge</span>
                    <p>We're live. Try it out!</p>
                  </a>
                </div>
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </header>
    <!-- header -->

    <!-- welcome -->
    <section class="p-0 bg-light">
      <div class="image image-overlay image-cover" style="background-image:url(app/assets/images/demo/minimal/portfolio-bg-2.jpg)"
      data-top-top="transform: translateY(0px);" 
      data-top-bottom="transform: translateY(-250px);"></div>
      <div class="container">
        <div class="row justify-content-center align-items-end vh-50 mb-5">
          <div class="col col-md-10 col-lg-8">
            <div class="row align-items-center">
              <div class="col-4 col-lg-3">
                <img class="mr-3 avatar avatar-xl rounded" src="app/assets/images/demo/ms-icon-310x310.png" alt="Generic placeholder image">
              </div>
              <div class="col">
                <div class="row align-items-center">
                  <div class="col-md-8">
                    <h2 class="mb-0">Welcome to <b>Nceno</b></h2>
                    <span class="text-muted">Workout for a Payout</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- / welcome -->

    <!--tabs instead of accordion -->
    <section class="bg-light p-0">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col col-md-10 col-lg-8">
            <div class="nav nav-tabs mb-1">
              <a class="nav-item nav-link active" data-toggle="tab" href="#demo-2-2">Sign in</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#demo-2-4">Host</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#demo-2-3">Manage</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#demo-2-5">Browse</a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- / tabs instead of accordion -->


    <section class="bg-light pt-2">

      <div class="container">
        <div class="tab-content" id="demo-2">

          <!-- sign in -->
          <div class="tab-pane show active" id="demo-2-2" role="tabpanel" aria-labelledby="demo-2-2">
            <div class="viewport">
              <div class="image image-overlay" style="background-image:url(app/assets/images/demo/image-2.jpg)"></div>
              <div class="container">
                <div class="row justify-content-center align-items-center vh-100">
                  <div class="col-md-6 col-lg-5">
                    <div class="accordion-group accordion-group-portal" data-accordion-group>
                      <div class="accordion open" data-accordion>
                        <div class="accordion-control" data-control>
                          <h5>Sign In</h5>
                        </div>
                        <div class="accordion-content" data-content>
                          <div class="accordion-content-wrapper">
                            <form>
                              <a id="fitbitBtn" href="https://www.fitbit.com/oauth2/authorize?response_type=token&client_id=22D5SN&redirect_uri=https%3A%2F%2Fwww.nceno.app%2FsetGoal.html&scope=activity%20heartrate%20location%20profile&expires_in=604800" class="btn btn-primary btn-block">Step 1: Sign in with Fitbit</a>
                              <a id="portisBtn" class="btn btn-secondary btn-block" onclick="showPortis()">Step 2: Log into Portis</a>
                            </form>
                          </div>
                        </div>
                      </div>
                      <div class="accordion" data-accordion>
                        <div class="accordion-control" data-control>
                          <h5>Create profile</h5>
                          <p>(One-time only)</p>
                        </div>
                        <div class="accordion-content" data-content>
                          <div class="accordion-content-wrapper">
                            <form>
                              <div class="form-group">
                                <label for="exampleFormControlInput3">Username</label>
                                <input type="text" class="form-control" id="exampleFormControlInput3">
                              </div>
                              <div class="form-group">
                                <label for="exampleFormControlInput4">Email address</label>
                                <input type="email" class="form-control" id="exampleFormControlInput4" placeholder="name@example.com">
                              </div>
                              <div class="form-group">
                                <label for="exampleFormControlSelect5">Wearable brand</label>
                                <select class="form-control" id="exampleFormControlSelect5">
                                  <option>Fitbit</option>
                                  <option>Apple</option>
                                  <option>Garmin</option>
                                  <option>Samsung</option>
                                  <option>Xiaomi</option>
                                  <option>Other</option>
                                </select>
                              </div>
                              <a href="" class="btn btn-primary btn-block" id="makeAcctBtn">Create Nceno profile</a>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- / sign in -->

          <!-- manage -->
          <div class="tab-pane" id="demo-2-3" role="tabpanel" aria-labelledby="demo-2-3">
            <div class="row justify-content-center">
              <div class="col-md-10 col-lg-8">
                <h5 class="mb-2 fs-20 font-weight-normal">Host a new challenge</h5>
                  <form>
                    <div class="form-group">
                      <label for="chIDtools">Select one of your challenges:</label>
                      <select class="form-control" id="chIDtools">
                        <!-- options generated here -->
                      </select>
                    </div>
                <div class="row">
                  <div class="col">
                    <div class="table-responsive-md">
                      <table class="table table-lined">
                        <thead>
                          <tr>
                            <th scope="col">Date</th>
                            <th scope="col">Order</th>
                            <th scope="col">Price</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <th scope="row">July 20, 2018</th>
                            <td>#110</td>
                            <td>$8021.47</td>
                          </tr>
                          <tr>
                            <th scope="row">July 20, 2018</th>
                            <td>#111</td>
                            <td>$8021.47</td>
                          </tr>
                          <tr>
                            <th scope="row">July 22, 2018</th>
                            <td>#112</td>
                            <td>$815</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- / manage -->          

          <!-- host -->
          <div class="tab-pane" id="demo-2-4" role="tabpanel" aria-labelledby="demo-2-4">
            <div class="row justify-content-center">
              <div class="col-md-10 col-lg-8">

                <!--                 <div class="row mb-4">
                  <div class="col">
                    <div class="boxed">
                      <div class="row align-items-center justify-content-between p-3">
                        <div class="col-md-2 pb-2 pb-md-0 text-center">
                          <img src="app/assets/images/demo/user-5.jpg" alt="Avatar" class="avatar avatar-lg rounded">
                        </div>
                        <div class="col-md-5 text-center text-md-left">
                          <h4 class="mb-0"><b>Dill</b> Doe</h4>
                          <a href="" class="fs-14 link text-primary">Change Avatar</a>
                        </div>
                        <div class="col-md-4 text-center text-md-right mt-1 mt-md-0">
                          <a href="" class="btn btn-primary btn-rounded">Upgrade Plan</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div> -->

                <div class="row">
                  <div class="col">
                    <h5 class="mb-2 fs-20 font-weight-normal">Host a new challenge</h5>
                      <form>
                        <div class="form-group">
                          <label for="exampleFormControlInput3">Minutes per exercise session:</label>
                          <select class="form-control" id="exampleFormControlSelect5">
                            <option>20</option>
                            <option>30</option>
                            <option>40</option>
                            <option>50</option>
                            <option>60</option>
                            <option>70</option>
                            <option>80</option>
                            <option>90</option>
                            <option>100</option>
                            <option>110</option>
                            <option>120</option>
                          </select>
                        </div>
                        <div class="form-group">
                          <label for="exampleFormControlInput4">Exercise sessions per week:</label>
                          <select class="form-control" id="exampleFormControlSelect5">
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                          </select>
                        </div>
                        <div class="form-group">
                          <label for="exampleFormControlSelect5">Challenge duration (in weeks):</label>
                          <select class="form-control" id="exampleFormControlSelect5">
                            <option>2</option>
                            <option>4</option>
                            <option>6</option>
                            <option>8</option>
                            <option>10</option>
                            <option>12</option>
                          </select>
                        </div>
                        <div class="form-group">
                          <label for="exampleFormControlSelect5">Stake in $USD:</label>
                          <select class="form-control" id="exampleFormControlSelect5">
                            <option>5</option>
                            <option>10</option>
                            <option>20</option>
                            <option>35</option>
                            <option>50</option>
                            <option>75</option>
                            <option>100</option>
                            <option>150</option>
                            <option>250</option>
                            <option>500</option>
                            <option>1000</option>
                            <option>1500</option>
                            <option>2500</option>
                            <option>5000</option>
                          </select>
                        </div>
                        <div class="form-group">
                          <label for="exampleFormControlSelect1">Starting time:</label>
                            <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                                <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1"/>
                                <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                                    <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group form-check">
                          <input type="checkbox" class="form-check-input" id="checker">
                          <label class="form-check-label" for="checker">I've read the <a href="instructions.html">instructions</a> and agree to the <a href="terms.html">terms</a>.</label>
                        </div>                                                                        
                        <a href="" class="btn btn-primary" id="createBtn">Create this challenge</a>
                      </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- / host -->

          <!-- browse -->
          <div class="tab-pane" id="demo-2-5" role="tabpanel" aria-labelledby="demo-2-5">
            <div class="row justify-content-center">
              <div class="col-md-10 col-lg-8">

                <div class="row">
                  <div class="col">
                    <div class="table-responsive-md">
                      <table class="table table-lined">
                        <thead>
                          <tr>
                            <th scope="col">Date</th>
                            <th scope="col">Order</th>
                            <th scope="col">Price</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <th scope="row">July 20, 2018</th>
                            <td>#110</td>
                            <td>$8021.47</td>
                          </tr>
                          <tr>
                            <th scope="row">July 20, 2018</th>
                            <td>#111</td>
                            <td>$8021.47</td>
                          </tr>
                          <tr>
                            <th scope="row">July 22, 2018</th>
                            <td>#112</td>
                            <td>$815</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- / browse -->
        </div>
      </div>
    </section>



    <!-- footer -->
    <footer class="separator-top">
      <div class="separator-top">
        <div class="container py-5">
          <div class="row justify-content-between align-items-center">
            <div class="col-md-5 text-center text-md-left">
              <ul class="nav">
                <li class="nav-item">
                  <a class="nav-link" href="#">Contact</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="careers.html">Careers</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Legal</a>
                </li>
              </ul>
            </div>
            <div class="col-md-2 text-center">
              <img class="logo-sm" src="app/assets/images/demo/logo/logo-light.png" alt="Logo">
            </div>
            <div class="col-md-5 text-center text-md-right">
              <ul class="socials">
                <li><a href="" class="icon-facebook fs-20"></a></li>
                <li><a href="" class="icon-instagram fs-20"></a></li>
                <li><a href="" class="icon-twitter fs-20"></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- / footer -->

<!-- scripts -->
    <script src="app/assets/js/vendor.js"></script>
    <script src="app/assets/js/app.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>
    <script src="https://momentjs.com/downloads/moment.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js" integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/portis/dist/bundle.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css"/>
<!-- / scripts -->

<!--app logic -->
    <script>
      //$("#loader").hide();
      var PortisProvider = window.Portis.PortisProvider;
  // Check if Web3 has been injected by the browser (Mist/MetaMask)
  if (typeof web3 !== 'undefined') {
    // Use Mist/MetaMask's provider
    web3 = new Web3(web3.currentProvider);
  } else {
      // Fallback - use Portis
      web3 = new Web3(new PortisProvider({
      apiKey: "332bfe3ea28174fa515d478e23a1b31c",
      network: 'rinkeby'
      }));
    }

   function showPortis() {
      // will only open the portis menu
      web3.currentProvider.showPortis(() => {
        web3.eth.getAccounts().then(e => { 
          web3.eth.defaultAccount = e[0];
          console.log("default: " + web3.eth.defaultAccount);
        });
      })
    }

  

    var Nceno = new web3.eth.Contract([
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "name": "_activeMins",
        "type": "uint256"
      },
      {
        "name": "_stakeWEI",
        "type": "uint256"
      },
      {
        "name": "_sesPerWk",
        "type": "uint256"
      },
      {
        "name": "_wks",
        "type": "uint256"
      },
      {
        "name": "_startTime",
        "type": "uint256"
      },
      {
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "createGoal",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "name": "profileOf",
    "outputs": [
      {
        "name": "userID",
        "type": "bytes32"
      },
      {
        "name": "wearableModel",
        "type": "bytes32"
      },
      {
        "name": "name",
        "type": "bytes32"
      },
      {
        "name": "email",
        "type": "bytes32"
      },
      {
        "name": "walletAdr",
        "type": "address"
      },
      {
        "name": "goalTotal",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_index",
        "type": "uint256"
      }
    ],
    "name": "getFutureGoal",
    "outputs": [
      {
        "name": "",
        "type": "bytes32"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "bytes32[10]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "activeCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getSingleRev",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getPastRev",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "ncenoEmergencyCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_reportedMins",
        "type": "uint256"
      },
      {
        "name": "_timeStamp",
        "type": "uint256"
      },
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "simplePayout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getActiveRev",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getMyGoalStats2",
    "outputs": [
      {
        "name": "",
        "type": "uint256[12]"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256[12]"
      },
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getLeaderBoard",
    "outputs": [
      {
        "name": "",
        "type": "bytes32[10]"
      },
      {
        "name": "",
        "type": "uint256[12][10]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_wearableModel",
        "type": "bytes32"
      },
      {
        "name": "_name",
        "type": "bytes32"
      },
      {
        "name": "_email",
        "type": "bytes32"
      }
    ],
    "name": "createCompetitor",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_newChoices",
        "type": "uint256[12][6][2]"
      }
    ],
    "name": "setPartitionChoices",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_index",
        "type": "uint256"
      }
    ],
    "name": "getActiveGoal",
    "outputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "name": "userExists",
    "outputs": [
      {
        "name": "",
        "type": "bool"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "pastCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "claimBonus",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "joinGoal",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "goalCount",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getMyGoalStats1",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "singleCashout",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "getGoalParams",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "bytes32[10]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_wearableModel",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_name",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_email",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_walletAdr",
        "type": "address"
      }
    ],
    "name": "ProfileCreated",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_activeMins",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_stakeWEI",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_sesPerWk",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_wks",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_startTime",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      }
    ],
    "name": "GoalCreated",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      }
    ],
    "name": "CompetitorJoined",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_wk",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_payout",
        "type": "uint256"
      }
    ],
    "name": "PayoutRedeemedBy",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "_eventName",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_userID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_goalID",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "name": "_amount",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "_wk",
        "type": "uint256"
      }
    ],
    "name": "BonusClaimedBy",
    "type": "event"
  }
], '0xed2bcfbe945ae7de0eb480510ff7290b223929ae');

         console.log(Nceno);
        $("#createBtn").hide();
        //show create button only if user agrees to terms
        $("#checker").on('click', function() {
          if($("#checker").is(':checked')) {
            $("#createBtn").show();
            
          } else {
            $("#createBtn").hide();
            
          }
        });

        //call fitbit api with user creds
        //getting the access token from url
        var access_token = window.location.href.split('#')[1].split('=')[1].split('&')[0];
        // get the userID
        var fitbitUser = window.location.href.split('#')[1].split('=')[2].split('&')[0];
        var userID = web3.utils.padRight(web3.utils.toHex(fitbitUser),34);
        //log them
        console.log(access_token);
        console.log(fitbitUser);
        
//creating a competitor account
$("#makeAcctBtn").click(function() {
  Nceno.methods.createCompetitor(
    userID,
    web3.utils.padRight(web3.utils.toHex($("#wearable").val()),34),
    web3.utils.padRight(web3.utils.toHex($("#name").val()),34),
    web3.utils.padRight(web3.utils.toHex($("#email").val()),34)
  )
  .send({from: web3.eth.defaultAccount, gas: 200000, gasPrice: 15000000000},
    function(error, result) {
      if (!error){
        $("#makeAcctBtn").hide();
        console.log(result);
      }
      else
      console.error(error);
    }
  );
}); 

//creating a goal
var msgValue = Math.floor($("#stakeDD").val()*1000000000000000000/127);
var usdStakeInWei = msgValue.toString();
var goalID = web3.utils.randomHex(5);

$("#hostBtn").click(function() {
  var start = moment.unix($("#datetimepicker1").datetimepicker('date'));
  var trimmed = Math.floor(new Date(start).getTime()/1000000);
  console.log(usdStakeInWei, start, trimmed);
  //function call:
  Nceno.methods.createGoal(
    goalID,
    $("#activeMinsDD").val(),
    usdStakeInWei,
    $("#sesPerWkDD").val(),
    $("#wksDD").val(),
    trimmed,
    userID
  )
  .send({from: web3.eth.defaultAccount, gas: 2000000, gasPrice: 15000000000, value: msgValue},
    function(error, result) {
      if (!error){
        $("#hostBtn").hide();
        console.log(result);
      }
      else
      console.error(error);
    }
  );
});

function echoGoal(){
  $("#goalEcho").html("You're commiting $" + $("#stakeDD").val() + " to working out for " + $("#activeMinsDD").val() +"mins " + $("#sesPerWkDD").val()+" times per week for "+ $("#wksDD").val()+" weeks, starting automatically at "+ $("#datetimepicker1").data('date') +". The challenge ID is: "+ goalID+".");
}

function echoJoinedGoal(){
  var goalid = web3.utils.padRight($("#col[i]").val(),34)
  Nceno.methods.getGoalParams(
    goalid
  )
  .call({from: web3.eth.defaultAccount},
    function(error, result) {
      if (!error){
        var tstamp = new Date(result[4]*1000);
        $("#echoSelectedGoal").html(
          "Details for challenge "+ goalid.slice(0, 12) +
          ": You commited $" + 
          Math.floor(result[1]*127/1000000000000000000) + 
          " to working out for " + 
          result[0] +
          "mins " + 
          result[2] +
          " times per week for "+ 
          result[3] +
          " weeks, starting automatically at "+ 
          tstamp + 
          "."
        );
        console.log(result);
      }
      else
      console.error(error);
    }
  );
}
var populated = false;
function makeList(){
  //makes a list of active goals for a user
  if(populated === false){ 
    var i = 0;
    var goals = new Array();
    for (i = 0; i < 15; i++){
      Nceno.methods.getActiveGoal(userID, i).call({from: web3.eth.defaultAccount}, function(error, result){
        if(result != undefined){
          goals[i] = result;
          console.log(goals[i]);
          $("#chIDtools").append('<option>'+ goals[i].slice(0, 12) +'</option>');
        }
      });    
    }
    populated = true;
  }
}

function echoSelectedGoal(){
  var goalid = web3.utils.padRight($("#chIDtools").val(),34)
  Nceno.methods.getGoalParams(
    goalid
  )
  .call({from: web3.eth.defaultAccount},
    function(error, result) {
      if (!error){
        var tstamp = new Date(result[4]*1000);
        $("#echoSelectedGoal").html(
          "Details for challenge "+ goalid.slice(0, 12) +
          ": You commited $" + 
          Math.floor(result[1]*127/1000000000000000000) + 
          " to working out for " + 
          result[0] +
          "mins " + 
          result[2] +
          " times per week for "+ 
          result[3] +
          " weeks, starting automatically at "+ 
          tstamp + 
          "."
        );
        console.log(result);
      }
      else
      console.error(error);
    }
  );
}



$("#claimBtn").click(function() {
  var goalid = web3.utils.padRight($("#chIDtools").val(),34);
  //function call:
  Nceno.methods.claimBonus(
    goalid,
    userID
  )
  .send({from: web3.eth.defaultAccount, gas: 2000000, gasPrice: 15000000000},
    function(error, result) {
      if (!error){
        $("#claimBtn").hide();
        console.log(result);
      }
      else
      console.error(error);
    }
  );
});

$("#logBtn").click(function() {
var xhr = new XMLHttpRequest();
xhr.open('GET', 'https://api.fitbit.com/1/user/'+ fitbitUser +'/activities/heart/date/today/1d.json');
xhr.setRequestHeader("Authorization", 'Bearer ' + access_token);
xhr.onload = function() {
   if (xhr.status === 200) {
      //console.log(xhr.responseText);
      //document.write(xhr.responseText);
      
      var data = JSON.parse(xhr.responseText);
      var obj = [data];
      var fatBurn = obj[0]["activities-heart"][0].value.heartRateZones[1].minutes;
      var cardio = obj[0]["activities-heart"][0].value.heartRateZones[2].minutes;
      var peak = obj[0]["activities-heart"][0].value.heartRateZones[3].minutes;
      var formattedTime = Date.parse(obj[0]["activities-heart"][0].dateTime)/1000;

      console.log(fitbitUser +"'s active minutes for "+ obj[0]["activities-heart"][0].dateTime);
      console.log(obj[0]["activities-heart"][0].value.heartRateZones[1].minutes);
      console.log(obj[0]["activities-heart"][0].value.heartRateZones[2].minutes);
      console.log(obj[0]["activities-heart"][0].value.heartRateZones[3].minutes);
      console.log("time stamp: "+formattedTime);

      var sessionMins = fatBurn + cardio + peak;
      //var sessionMins = 32; //debug only
      console.log("total session minutes to be logged: "+sessionMins);

    
      Nceno.methods.simplePayout(userID, sessionMins, formattedTime+2, web3.utils.padRight($("#chIDtools").val(),34)).send(
        {from: web3.eth.defaultAccount, gas: 3000000, gasPrice: 15000000000},
          function(error, result) {
            if (!error){
              $("#logBtn").hide();
              console.log(result);
            }
            else
            console.error(error);
          });
    }
  };
  xhr.send()
  });//close click(function(){

   
  
  </script>
<!-- / app logic -->

  </body>
</html>