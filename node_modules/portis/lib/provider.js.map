{"version":3,"file":"provider.js","sourceRoot":"","sources":["../src/provider.ts"],"names":[],"mappings":"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","sourcesContent":["import { Payload, Network, ScopeType } from \"./types\";\nimport { isMobile, isLocalhost, randomId } from \"./utils\";\nimport { css } from './style';\n\nconst sdkVersion = '1.3.2';\nconst postMessages = {\n    PT_RESPONSE: 'PT_RESPONSE',\n    PT_HANDLE_REQUEST: 'PT_HANDLE_REQUEST',\n    PT_GREEN_LIGHT: 'PT_GREEN_LIGHT',\n    PT_SHOW_IFRAME: 'PT_SHOW_IFRAME',\n    PT_HIDE_IFRAME: 'PT_HIDE_IFRAME',\n    PT_USER_DENIED: 'PT_USER_DENIED',\n    PT_USER_LOGGED_IN: 'PT_USER_LOGGED_IN',\n    PT_PURCHASE_INITIATED: 'PT_PURCHASE_INITIATED',\n    PT_ON_DATA: 'PT_ON_DATA',\n    PT_SHOW_NOTIFICATION: 'PT_SHOW_NOTIFICATION',\n    PT_HIDE_NOTIFICATION: 'PT_HIDE_NOTIFICATION',\n};\nconst portisPayloadMethods = {\n    SET_DEFAULT_EMAIL: 'SET_DEFAULT_EMAIL',\n    SHOW_PORTIS: 'SHOW_PORTIS',\n    CHANGE_NETWORK: 'CHANGE_NETWORK',\n    SHOW_TX_DETAILS: 'SHOW_TX_DETAILS',\n    UPDATE_WIDGET_LOCATION: 'UPDATE_WIDGET_LOCATION',\n};\n\nexport class PortisProvider {\n    portisClient = 'https://app.portis.io';\n    requests: { [id: string]: { payload: Payload, cb } } = {};\n    queue: { payload: Payload, cb }[] = [];\n    elements: Promise<{ wrapper: HTMLDivElement, iframe: HTMLIFrameElement, notification: HTMLDivElement }>;\n    iframeReady: boolean;\n    account: string | null = null;\n    network: string | null = null;\n    isPortis = true;\n    referrerAppOptions;\n    events: { eventName: string, callback }[] = [];\n    portisViewportMetaTag;\n    dappViewportMetaTag;\n\n    constructor(opts: { apiKey: string, network?: Network, infuraApiKey?: string, providerNodeUrl?: string, scope?: ScopeType[] }) {\n        if (!isLocalhost() && !opts.apiKey) {\n            throw 'apiKey is missing. Please check your apiKey in the Portis dashboard: https://app.portis.io/dashboard';\n        }\n\n        if (opts.infuraApiKey && opts.providerNodeUrl) {\n            throw 'Invalid parameters. \\'infuraApiKey\\' and \\'providerNodeUrl\\' cannot be both provided. Refer to the Portis documentation for more info.';\n        }\n\n        this.referrerAppOptions = {\n            sdkVersion,\n            network: opts.network || 'mainnet',\n            apiKey: opts.apiKey,\n            infuraApiKey: opts.infuraApiKey,\n            providerNodeUrl: opts.providerNodeUrl,\n            scope: opts.scope,\n        };\n        this.elements = this.createIframe();\n        this.listen();\n    }\n\n    sendAsync(payload: Payload, cb) {\n        this.enqueue(payload, cb);\n    }\n\n    send(payload: Payload, cb?) {\n        if (cb) {\n            this.sendAsync(payload, cb);\n            return;\n        }\n\n        let result;\n\n        switch (payload.method) {\n\n            case 'eth_accounts':\n                const account = this.account;\n                result = account ? [account] : [];\n                break;\n\n            case 'eth_coinbase':\n                result = this.account;\n                break;\n\n            case 'net_version':\n                result = this.network;\n                break;\n\n            case 'eth_uninstallFilter':\n                this.sendAsync(payload, (_) => _);\n                result = true;\n                break;\n\n            default:\n                throw new Error(`The Portis Web3 object does not support synchronous methods like ${payload.method} without a callback parameter.`);\n        }\n\n        return {\n            id: payload.id,\n            jsonrpc: payload.jsonrpc,\n            result: result,\n        }\n    }\n\n    isConnected() {\n        return true;\n    }\n\n    setDefaultEmail(email: string, editable: boolean = true) {\n        this.sendGenericPayload(portisPayloadMethods.SET_DEFAULT_EMAIL, [email, editable]);\n    }\n\n    showPortis(callback) {\n        this.sendGenericPayload(portisPayloadMethods.SHOW_PORTIS, [], callback);\n    }\n\n    on(eventName: string, callback) {\n        this.events.push({ eventName, callback });\n    }\n\n    enable() {\n        return new Promise((resolve, reject) => {\n            this.sendGenericPayload('eth_accounts', undefined, (err, resp) => {\n                if (err) {\n                    reject(err);\n                } else {\n                    resolve(resp.result);\n                }\n            })\n        });\n    }\n\n    changeNetwork(opts: { network?: Network, infuraApiKey?: string, providerNodeUrl?: string }, callback?: (err, resp) => void) {\n        if (opts.network) {\n            this.referrerAppOptions.network = opts.network;\n        }\n\n        if (opts.infuraApiKey) {\n            this.referrerAppOptions.infuraApiKey = opts.infuraApiKey;\n        }\n\n        if (opts.providerNodeUrl) {\n            this.referrerAppOptions.providerNodeUrl = opts.providerNodeUrl;\n        }\n\n        this.sendGenericPayload(portisPayloadMethods.CHANGE_NETWORK, [opts.network, opts.infuraApiKey, opts.providerNodeUrl], callback);\n    }\n\n    private sendGenericPayload(method: string, params: any[] = [], callback: (err, resp) => any = _ => _) {\n        const payload = {\n            id: randomId(),\n            jsonrpc: '2.0',\n            method,\n            params,\n        };\n        this.enqueue(payload, callback);\n    }\n\n    private createIframe(): Promise<{ wrapper: HTMLDivElement, iframe: HTMLIFrameElement, notification: HTMLDivElement }> {\n        return new Promise((resolve, reject) => {\n            const onload = () => {\n                const mobile = isMobile();\n                const wrapper = document.createElement('div');\n                const iframe = document.createElement('iframe');\n                const styleElem = document.createElement('style');\n                const viewportMetaTag = document.createElement('meta');\n                const notification = document.createElement('div');\n                const notificationDetails = document.createElement('div');\n                const notificationLogo = document.createElement('img');\n                const notificationText = document.createElement('span');\n                const showDetailsBtn = document.createElement('a');\n\n                wrapper.className = mobile ? 'portis-mobile-wrapper' : 'portis-wrapper';\n                iframe.className = mobile ? 'portis-mobile-iframe' : 'portis-iframe';\n                notificationDetails.className = 'portis-notification-details';\n                notification.className = mobile ? 'portis-mobile-notification' : 'portis-notification';\n                notificationLogo.src = 'https://assets.portis.io/portis-logo/logo_64_64.png';\n                notificationLogo.className = 'portis-notifiction-logo';\n                iframe.src = `${this.portisClient}/send/?p=${btoa(JSON.stringify(this.referrerAppOptions))}`;\n                styleElem.innerHTML = css;\n                viewportMetaTag.name = 'viewport';\n                viewportMetaTag.content = 'width=device-width, initial-scale=1';\n                showDetailsBtn.innerHTML = 'Details';\n                showDetailsBtn.onclick = () => {\n                    this.sendGenericPayload(portisPayloadMethods.SHOW_TX_DETAILS);\n                };\n                showDetailsBtn.className = 'portis-notification-button';\n\n                notificationDetails.appendChild(notificationLogo);\n                notificationDetails.appendChild(notificationText);\n                notification.appendChild(notificationDetails);\n                notification.appendChild(showDetailsBtn);\n                wrapper.appendChild(iframe);\n                document.body.appendChild(wrapper);\n                document.body.appendChild(notification);\n                document.head.appendChild(styleElem);\n                this.portisViewportMetaTag = viewportMetaTag;\n                this.dappViewportMetaTag = this.getDappViewportMetaTag();\n\n                resolve({ wrapper, iframe, notification });\n            }\n\n            if (['loaded', 'interactive', 'complete'].indexOf(document.readyState) > -1) {\n                onload();\n            } else {\n                window.addEventListener('load', onload.bind(this), false);\n            }\n        });\n    }\n\n    private showIframe() {\n        this.elements.then(elements => {\n            elements.wrapper.style.display = 'block';\n            this.sendGenericPayload(portisPayloadMethods.UPDATE_WIDGET_LOCATION, [elements.wrapper.getBoundingClientRect()]);\n            if (isMobile()) {\n                document.body.style.overflow = 'hidden';\n                this.setPortisViewport();\n            }\n        });\n    }\n\n    private hideIframe() {\n        this.elements.then(elements => {\n            elements.wrapper.style.display = 'none';\n\n            if (isMobile()) {\n                document.body.style.overflow = 'inherit';\n                this.setDappViewport();\n            }\n        });\n    }\n\n    private showNotification(msg: string, showDetailsButton?: boolean) {\n        this.elements.then(elements => {\n            const button = elements.notification.querySelector('a');\n            if (button) {\n                button.style.display = showDetailsButton ? 'initial' : 'none';\n            }\n\n            const span = elements.notification.querySelector('span');\n            if (span) {\n                span.innerText = msg;\n                elements.notification.style.display = 'flex';\n            }\n        });\n    }\n\n    private hideNotification() {\n        this.elements.then(elements => {\n            const span = elements.notification.querySelector('span');\n            if (span) {\n                span.innerText = '';\n                elements.notification.style.display = 'none';\n            }\n        });\n    }\n\n    private getDappViewportMetaTag() {\n        const metaTags = document.head.querySelectorAll('meta[name=viewport]');\n        return metaTags.length ? metaTags[metaTags.length - 1] : null;\n    }\n\n    private setPortisViewport() {\n        document.head.appendChild(this.portisViewportMetaTag);\n\n        if (this.dappViewportMetaTag) {\n            this.dappViewportMetaTag.remove();\n        }\n    }\n\n    private setDappViewport() {\n        if (this.portisViewportMetaTag) {\n            this.portisViewportMetaTag.remove();\n        }\n\n        if (this.dappViewportMetaTag) {\n            document.head.appendChild(this.dappViewportMetaTag);\n        }\n    }\n\n    private enqueue(payload: Payload, cb) {\n        this.queue.push({ payload, cb });\n\n        if (this.iframeReady) {\n            this.dequeue();\n        }\n    }\n\n    private dequeue() {\n        if (this.queue.length == 0) {\n            return;\n        }\n\n        const item = this.queue.shift();\n\n        if (item) {\n            const payload = item.payload;\n            const cb = item.cb;\n            const id = Array.isArray(payload) ?\n                payload.map(i => i.id).join(':') :\n                payload.id;\n            this.sendPostMessage(postMessages.PT_HANDLE_REQUEST, payload);\n            this.requests[id] = { payload, cb };\n            this.dequeue();\n        }\n    }\n\n    private sendPostMessage(msgType: string, payload?: Object) {\n        this.elements.then(elements => {\n            if (elements.iframe.contentWindow) {\n                elements.iframe.contentWindow.postMessage({ msgType, payload }, '*');\n            }\n        });\n    }\n\n    private listen() {\n        window.addEventListener('message', (evt) => {\n            if (evt.origin === this.portisClient) {\n                switch (evt.data.msgType) {\n\n                    case postMessages.PT_GREEN_LIGHT: {\n                        this.iframeReady = true;\n                        this.dequeue();\n                        break;\n                    }\n\n                    case postMessages.PT_RESPONSE: {\n                        const id = Array.isArray(evt.data.response) ?\n                            evt.data.response.map(i => i.id).join(':') :\n                            evt.data.response.id;\n                        this.requests[id].cb(null, evt.data.response);\n\n                        if (this.requests[id].payload.method === 'eth_accounts' || this.requests[id].payload.method === 'eth_coinbase') {\n                            this.account = evt.data.response.result[0];\n                        }\n\n                        if (this.requests[id].payload.method === 'net_version') {\n                            this.network = evt.data.response.result;\n                        }\n\n                        this.dequeue();\n                        break;\n                    }\n\n                    case postMessages.PT_SHOW_IFRAME: {\n                        this.showIframe();\n                        break;\n                    }\n\n                    case postMessages.PT_HIDE_IFRAME: {\n                        this.hideIframe();\n                        break;\n                    }\n\n                    case postMessages.PT_SHOW_NOTIFICATION: {\n                        this.showNotification(evt.data.response.message, evt.data.response.showDetailsButton);\n                        break;\n                    }\n\n                    case postMessages.PT_HIDE_NOTIFICATION: {\n                        this.hideNotification();\n                        break;\n                    }\n\n                    case postMessages.PT_USER_DENIED: {\n                        const id = evt.data.response ? evt.data.response.id : null;\n\n                        if (id) {\n                            this.requests[id].cb(new Error('User denied transaction signature.'));\n                        } else {\n                            this.queue.forEach(item => item.cb(new Error('User denied transaction signature.')));\n                        }\n\n                        this.dequeue();\n                        break;\n                    }\n\n                    case postMessages.PT_USER_LOGGED_IN: {\n                        this.events\n                            .filter(event => event.eventName == 'login')\n                            .forEach(event => event.callback({\n                                provider: 'portis',\n                                address: evt.data.response.address,\n                                email: evt.data.response.email,\n                            }));\n                        break;\n                    }\n\n                    case postMessages.PT_PURCHASE_INITIATED: {\n                        this.events\n                            .filter(event => event.eventName == 'purchase-initiated')\n                            .forEach(event => event.callback({\n                                provider: 'portis',\n                                purchaseId: evt.data.response.purchaseId,\n                            }));\n                        break;\n                    }\n\n                    case postMessages.PT_ON_DATA: {\n                        this.events\n                            .filter(event => event.eventName == 'data')\n                            .forEach(event => event.callback(evt.data.response));\n                        break;\n                    }\n                }\n            }\n        }, false);\n    }\n}\n"]}