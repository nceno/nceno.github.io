{"version":3,"file":"bundle.min.js","sources":["../src/utils.ts","../src/style.ts","../src/provider.ts"],"sourcesContent":["declare global {\n    interface Window { opera: any; }\n}\n\nexport function isMobile() {\n    var check = false;\n    (function (a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n    return check;\n}\n\nexport function isLocalhost() {\n    return location.hostname === 'localhost' || location.hostname === '127.0.0.1';\n}\n\nexport function randomId() {\n    const upperBound = Math.pow(10, 7);\n    const lowerBound = 1;\n    return Math.floor(Math.random() * (upperBound - lowerBound) + lowerBound);\n}\n","export const css = `\n.portis-wrapper {\n    display: none;\n    position: fixed;\n    top: 10px;\n    right: 20px;\n    height: 525px;\n    width: 390px;\n    border-radius: 8px;\n    z-index: 2147483647;\n    box-shadow: rgba(0, 0, 0, 0.16) 0px 5px 40px;\n    animation: portis-entrance 250ms ease-in-out forwards;\n    opacity: 0;\n}\n\n.portis-iframe {\n    display: block;\n    width: 100%;\n    height: 100%;\n    border: none;\n    border-radius: 8px;\n}\n\n.portis-mobile-wrapper {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 2147483647;\n}\n\n.portis-mobile-iframe {\n    display: block;\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n.portis-notification {\n    display: none;\n    position: fixed;\n    bottom: 10px;\n    right: 20px;\n    height: 50px;\n    width: 390px;\n    border-radius: 8px;\n    z-index: 2147483647;\n    box-shadow: rgba(0, 0, 0, 0.16) 0px 5px 40px;\n    animation: portis-notification-entrance 250ms ease-in-out forwards;\n    opacity: 0;\n    font-family: BlinkMacSystemFont,-apple-system,\"Segoe UI\",Roboto,Oxygen,Ubuntu,Cantarell,\"Fira Sans\",\"Droid Sans\",\"Helvetica Neue\",Helvetica,Arial,sans-serif;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 10px;\n    background-color: white;\n}\n\n.portis-mobile-notification {\n    display: none;\n    position: fixed;\n    bottom: 10px;\n    right: 0;\n    left: 0;\n    height: 50px;\n    width: calc(100% - 20px);\n    margin: 0 10px;\n    border-radius: 8px;\n    z-index: 2147483647;\n    animation: portis-notification-entrance 250ms ease-in-out forwards;\n    opacity: 0;\n    font-family: BlinkMacSystemFont,-apple-system,\"Segoe UI\",Roboto,Oxygen,Ubuntu,Cantarell,\"Fira Sans\",\"Droid Sans\",\"Helvetica Neue\",Helvetica,Arial,sans-serif;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 10px;\n    background-color: white;\n}\n\n.portis-notifiction-logo {\n    width: 25px;\n    margin-right: 10px;\n}\n\n.portis-notification-details {\n    display: flex;\n    align-items: center;\n}\n\n.portis-notification-button {\n    cursor: pointer;\n}\n\n@keyframes portis-entrance {\n    100% { opacity: 1; top: 20px; }\n}\n\n@keyframes portis-notification-entrance {\n    100% { opacity: 1; bottom: 20px; }\n}\n`\n","import { Payload, Network, ScopeType } from \"./types\";\nimport { isMobile, isLocalhost, randomId } from \"./utils\";\nimport { css } from './style';\n\nconst sdkVersion = '1.3.2';\nconst postMessages = {\n    PT_RESPONSE: 'PT_RESPONSE',\n    PT_HANDLE_REQUEST: 'PT_HANDLE_REQUEST',\n    PT_GREEN_LIGHT: 'PT_GREEN_LIGHT',\n    PT_SHOW_IFRAME: 'PT_SHOW_IFRAME',\n    PT_HIDE_IFRAME: 'PT_HIDE_IFRAME',\n    PT_USER_DENIED: 'PT_USER_DENIED',\n    PT_USER_LOGGED_IN: 'PT_USER_LOGGED_IN',\n    PT_PURCHASE_INITIATED: 'PT_PURCHASE_INITIATED',\n    PT_ON_DATA: 'PT_ON_DATA',\n    PT_SHOW_NOTIFICATION: 'PT_SHOW_NOTIFICATION',\n    PT_HIDE_NOTIFICATION: 'PT_HIDE_NOTIFICATION',\n};\nconst portisPayloadMethods = {\n    SET_DEFAULT_EMAIL: 'SET_DEFAULT_EMAIL',\n    SHOW_PORTIS: 'SHOW_PORTIS',\n    CHANGE_NETWORK: 'CHANGE_NETWORK',\n    SHOW_TX_DETAILS: 'SHOW_TX_DETAILS',\n    UPDATE_WIDGET_LOCATION: 'UPDATE_WIDGET_LOCATION',\n};\n\nexport class PortisProvider {\n    portisClient = 'https://app.portis.io';\n    requests: { [id: string]: { payload: Payload, cb } } = {};\n    queue: { payload: Payload, cb }[] = [];\n    elements: Promise<{ wrapper: HTMLDivElement, iframe: HTMLIFrameElement, notification: HTMLDivElement }>;\n    iframeReady: boolean;\n    account: string | null = null;\n    network: string | null = null;\n    isPortis = true;\n    referrerAppOptions;\n    events: { eventName: string, callback }[] = [];\n    portisViewportMetaTag;\n    dappViewportMetaTag;\n\n    constructor(opts: { apiKey: string, network?: Network, infuraApiKey?: string, providerNodeUrl?: string, scope?: ScopeType[] }) {\n        if (!isLocalhost() && !opts.apiKey) {\n            throw 'apiKey is missing. Please check your apiKey in the Portis dashboard: https://app.portis.io/dashboard';\n        }\n\n        if (opts.infuraApiKey && opts.providerNodeUrl) {\n            throw 'Invalid parameters. \\'infuraApiKey\\' and \\'providerNodeUrl\\' cannot be both provided. Refer to the Portis documentation for more info.';\n        }\n\n        this.referrerAppOptions = {\n            sdkVersion,\n            network: opts.network || 'mainnet',\n            apiKey: opts.apiKey,\n            infuraApiKey: opts.infuraApiKey,\n            providerNodeUrl: opts.providerNodeUrl,\n            scope: opts.scope,\n        };\n        this.elements = this.createIframe();\n        this.listen();\n    }\n\n    sendAsync(payload: Payload, cb) {\n        this.enqueue(payload, cb);\n    }\n\n    send(payload: Payload, cb?) {\n        if (cb) {\n            this.sendAsync(payload, cb);\n            return;\n        }\n\n        let result;\n\n        switch (payload.method) {\n\n            case 'eth_accounts':\n                const account = this.account;\n                result = account ? [account] : [];\n                break;\n\n            case 'eth_coinbase':\n                result = this.account;\n                break;\n\n            case 'net_version':\n                result = this.network;\n                break;\n\n            case 'eth_uninstallFilter':\n                this.sendAsync(payload, (_) => _);\n                result = true;\n                break;\n\n            default:\n                throw new Error(`The Portis Web3 object does not support synchronous methods like ${payload.method} without a callback parameter.`);\n        }\n\n        return {\n            id: payload.id,\n            jsonrpc: payload.jsonrpc,\n            result: result,\n        }\n    }\n\n    isConnected() {\n        return true;\n    }\n\n    setDefaultEmail(email: string, editable: boolean = true) {\n        this.sendGenericPayload(portisPayloadMethods.SET_DEFAULT_EMAIL, [email, editable]);\n    }\n\n    showPortis(callback) {\n        this.sendGenericPayload(portisPayloadMethods.SHOW_PORTIS, [], callback);\n    }\n\n    on(eventName: string, callback) {\n        this.events.push({ eventName, callback });\n    }\n\n    enable() {\n        return new Promise((resolve, reject) => {\n            this.sendGenericPayload('eth_accounts', undefined, (err, resp) => {\n                if (err) {\n                    reject(err);\n                } else {\n                    resolve(resp.result);\n                }\n            })\n        });\n    }\n\n    changeNetwork(opts: { network?: Network, infuraApiKey?: string, providerNodeUrl?: string }, callback?: (err, resp) => void) {\n        if (opts.network) {\n            this.referrerAppOptions.network = opts.network;\n        }\n\n        if (opts.infuraApiKey) {\n            this.referrerAppOptions.infuraApiKey = opts.infuraApiKey;\n        }\n\n        if (opts.providerNodeUrl) {\n            this.referrerAppOptions.providerNodeUrl = opts.providerNodeUrl;\n        }\n\n        this.sendGenericPayload(portisPayloadMethods.CHANGE_NETWORK, [opts.network, opts.infuraApiKey, opts.providerNodeUrl], callback);\n    }\n\n    private sendGenericPayload(method: string, params: any[] = [], callback: (err, resp) => any = _ => _) {\n        const payload = {\n            id: randomId(),\n            jsonrpc: '2.0',\n            method,\n            params,\n        };\n        this.enqueue(payload, callback);\n    }\n\n    private createIframe(): Promise<{ wrapper: HTMLDivElement, iframe: HTMLIFrameElement, notification: HTMLDivElement }> {\n        return new Promise((resolve, reject) => {\n            const onload = () => {\n                const mobile = isMobile();\n                const wrapper = document.createElement('div');\n                const iframe = document.createElement('iframe');\n                const styleElem = document.createElement('style');\n                const viewportMetaTag = document.createElement('meta');\n                const notification = document.createElement('div');\n                const notificationDetails = document.createElement('div');\n                const notificationLogo = document.createElement('img');\n                const notificationText = document.createElement('span');\n                const showDetailsBtn = document.createElement('a');\n\n                wrapper.className = mobile ? 'portis-mobile-wrapper' : 'portis-wrapper';\n                iframe.className = mobile ? 'portis-mobile-iframe' : 'portis-iframe';\n                notificationDetails.className = 'portis-notification-details';\n                notification.className = mobile ? 'portis-mobile-notification' : 'portis-notification';\n                notificationLogo.src = 'https://assets.portis.io/portis-logo/logo_64_64.png';\n                notificationLogo.className = 'portis-notifiction-logo';\n                iframe.src = `${this.portisClient}/send/?p=${btoa(JSON.stringify(this.referrerAppOptions))}`;\n                styleElem.innerHTML = css;\n                viewportMetaTag.name = 'viewport';\n                viewportMetaTag.content = 'width=device-width, initial-scale=1';\n                showDetailsBtn.innerHTML = 'Details';\n                showDetailsBtn.onclick = () => {\n                    this.sendGenericPayload(portisPayloadMethods.SHOW_TX_DETAILS);\n                };\n                showDetailsBtn.className = 'portis-notification-button';\n\n                notificationDetails.appendChild(notificationLogo);\n                notificationDetails.appendChild(notificationText);\n                notification.appendChild(notificationDetails);\n                notification.appendChild(showDetailsBtn);\n                wrapper.appendChild(iframe);\n                document.body.appendChild(wrapper);\n                document.body.appendChild(notification);\n                document.head.appendChild(styleElem);\n                this.portisViewportMetaTag = viewportMetaTag;\n                this.dappViewportMetaTag = this.getDappViewportMetaTag();\n\n                resolve({ wrapper, iframe, notification });\n            }\n\n            if (['loaded', 'interactive', 'complete'].indexOf(document.readyState) > -1) {\n                onload();\n            } else {\n                window.addEventListener('load', onload.bind(this), false);\n            }\n        });\n    }\n\n    private showIframe() {\n        this.elements.then(elements => {\n            elements.wrapper.style.display = 'block';\n            this.sendGenericPayload(portisPayloadMethods.UPDATE_WIDGET_LOCATION, [elements.wrapper.getBoundingClientRect()]);\n            if (isMobile()) {\n                document.body.style.overflow = 'hidden';\n                this.setPortisViewport();\n            }\n        });\n    }\n\n    private hideIframe() {\n        this.elements.then(elements => {\n            elements.wrapper.style.display = 'none';\n\n            if (isMobile()) {\n                document.body.style.overflow = 'inherit';\n                this.setDappViewport();\n            }\n        });\n    }\n\n    private showNotification(msg: string, showDetailsButton?: boolean) {\n        this.elements.then(elements => {\n            const button = elements.notification.querySelector('a');\n            if (button) {\n                button.style.display = showDetailsButton ? 'initial' : 'none';\n            }\n\n            const span = elements.notification.querySelector('span');\n            if (span) {\n                span.innerText = msg;\n                elements.notification.style.display = 'flex';\n            }\n        });\n    }\n\n    private hideNotification() {\n        this.elements.then(elements => {\n            const span = elements.notification.querySelector('span');\n            if (span) {\n                span.innerText = '';\n                elements.notification.style.display = 'none';\n            }\n        });\n    }\n\n    private getDappViewportMetaTag() {\n        const metaTags = document.head.querySelectorAll('meta[name=viewport]');\n        return metaTags.length ? metaTags[metaTags.length - 1] : null;\n    }\n\n    private setPortisViewport() {\n        document.head.appendChild(this.portisViewportMetaTag);\n\n        if (this.dappViewportMetaTag) {\n            this.dappViewportMetaTag.remove();\n        }\n    }\n\n    private setDappViewport() {\n        if (this.portisViewportMetaTag) {\n            this.portisViewportMetaTag.remove();\n        }\n\n        if (this.dappViewportMetaTag) {\n            document.head.appendChild(this.dappViewportMetaTag);\n        }\n    }\n\n    private enqueue(payload: Payload, cb) {\n        this.queue.push({ payload, cb });\n\n        if (this.iframeReady) {\n            this.dequeue();\n        }\n    }\n\n    private dequeue() {\n        if (this.queue.length == 0) {\n            return;\n        }\n\n        const item = this.queue.shift();\n\n        if (item) {\n            const payload = item.payload;\n            const cb = item.cb;\n            const id = Array.isArray(payload) ?\n                payload.map(i => i.id).join(':') :\n                payload.id;\n            this.sendPostMessage(postMessages.PT_HANDLE_REQUEST, payload);\n            this.requests[id] = { payload, cb };\n            this.dequeue();\n        }\n    }\n\n    private sendPostMessage(msgType: string, payload?: Object) {\n        this.elements.then(elements => {\n            if (elements.iframe.contentWindow) {\n                elements.iframe.contentWindow.postMessage({ msgType, payload }, '*');\n            }\n        });\n    }\n\n    private listen() {\n        window.addEventListener('message', (evt) => {\n            if (evt.origin === this.portisClient) {\n                switch (evt.data.msgType) {\n\n                    case postMessages.PT_GREEN_LIGHT: {\n                        this.iframeReady = true;\n                        this.dequeue();\n                        break;\n                    }\n\n                    case postMessages.PT_RESPONSE: {\n                        const id = Array.isArray(evt.data.response) ?\n                            evt.data.response.map(i => i.id).join(':') :\n                            evt.data.response.id;\n                        this.requests[id].cb(null, evt.data.response);\n\n                        if (this.requests[id].payload.method === 'eth_accounts' || this.requests[id].payload.method === 'eth_coinbase') {\n                            this.account = evt.data.response.result[0];\n                        }\n\n                        if (this.requests[id].payload.method === 'net_version') {\n                            this.network = evt.data.response.result;\n                        }\n\n                        this.dequeue();\n                        break;\n                    }\n\n                    case postMessages.PT_SHOW_IFRAME: {\n                        this.showIframe();\n                        break;\n                    }\n\n                    case postMessages.PT_HIDE_IFRAME: {\n                        this.hideIframe();\n                        break;\n                    }\n\n                    case postMessages.PT_SHOW_NOTIFICATION: {\n                        this.showNotification(evt.data.response.message, evt.data.response.showDetailsButton);\n                        break;\n                    }\n\n                    case postMessages.PT_HIDE_NOTIFICATION: {\n                        this.hideNotification();\n                        break;\n                    }\n\n                    case postMessages.PT_USER_DENIED: {\n                        const id = evt.data.response ? evt.data.response.id : null;\n\n                        if (id) {\n                            this.requests[id].cb(new Error('User denied transaction signature.'));\n                        } else {\n                            this.queue.forEach(item => item.cb(new Error('User denied transaction signature.')));\n                        }\n\n                        this.dequeue();\n                        break;\n                    }\n\n                    case postMessages.PT_USER_LOGGED_IN: {\n                        this.events\n                            .filter(event => event.eventName == 'login')\n                            .forEach(event => event.callback({\n                                provider: 'portis',\n                                address: evt.data.response.address,\n                                email: evt.data.response.email,\n                            }));\n                        break;\n                    }\n\n                    case postMessages.PT_PURCHASE_INITIATED: {\n                        this.events\n                            .filter(event => event.eventName == 'purchase-initiated')\n                            .forEach(event => event.callback({\n                                provider: 'portis',\n                                purchaseId: evt.data.response.purchaseId,\n                            }));\n                        break;\n                    }\n\n                    case postMessages.PT_ON_DATA: {\n                        this.events\n                            .filter(event => event.eventName == 'data')\n                            .forEach(event => event.callback(evt.data.response));\n                        break;\n                    }\n                }\n            }\n        }, false);\n    }\n}\n"],"names":["a","check","navigator","userAgent","vendor","window","opera","test","substr","postMessages","portisPayloadMethods","opts","this","location","hostname","apiKey","infuraApiKey","providerNodeUrl","referrerAppOptions","sdkVersion","network","scope","elements","createIframe","listen","PortisProvider","payload","cb","enqueue","result","method","account","sendAsync","_","Error","id","jsonrpc","email","editable","sendGenericPayload","callback","eventName","events","push","Promise","resolve","reject","_this","undefined","err","resp","params","upperBound","Math","pow","floor","random","onload","mobile","isMobile","wrapper","document","createElement","iframe","styleElem","viewportMetaTag","notification","notificationDetails","notificationLogo","notificationText","showDetailsBtn","className","src","portisClient","btoa","JSON","stringify","innerHTML","name","content","onclick","appendChild","body","head","portisViewportMetaTag","dappViewportMetaTag","getDappViewportMetaTag","indexOf","readyState","addEventListener","bind","then","style","display","getBoundingClientRect","overflow","setPortisViewport","setDappViewport","msg","showDetailsButton","button","querySelector","span","innerText","metaTags","querySelectorAll","length","remove","queue","iframeReady","dequeue","item","shift","Array","isArray","map","i","join","sendPostMessage","requests","msgType","contentWindow","postMessage","evt","origin","data","response","showIframe","hideIframe","showNotification","message","hideNotification","forEach","filter","event","provider","address","purchaseId"],"mappings":"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"}